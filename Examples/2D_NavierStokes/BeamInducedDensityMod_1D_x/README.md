# Beam-Induced Density Modulation (1D in x)

## Overview

Simulation of density modulation induced by photo-chemical heating from a laser beam. This test case demonstrates the coupling between fluid dynamics and chemical heating source terms. This is a 1D problem (variation in x only) solved using the 2D Navier-Stokes solver with y as a dummy dimension.

## Governing Equations

2D Navier-Stokes equations with chemical heating source term:

```
d   [ rho   ]   d   [   rho*u    ]    d  [   rho*v   ]                    [     0       ]
--  [ rho*u ] + --  [rho*u*u + p ] +  -- [  rho*u*v  ] =  viscous terms + [     0       ]
dt  [ rho*v ]   dx  [   rho*u*v  ]    dy [rho*v*v + p]                    [     0       ]
    [   e   ]       [   (e+p)*u  ]       [  (e+p)v   ]                    [ Q/(gamma-1) ]
```

Where:
- `rho` - density
- `u` - x-velocity
- `v` - y-velocity
- `p` - pressure
- `e` - internal energy
- `Q` - heating due to photo-chemical reactions

Equation of state:
```
         p         1
e = -------  +   - rho * (u^2+v^2)
    gamma-1      2
```

## Non-Dimensionalization

See `aux/init.C` for normalization details.

Physical parameters:
- Reynolds number = 146.5
- Prandtl number = 0.671

## Domain and Boundary Conditions

- Domain: `-2.5*lambda_ac <= x <= 2.5*lambda_ac` (where `lambda_ac` is the acoustic spatial period, see `aux/init.C`)
- Boundary conditions along x: Extrapolate
- Boundary conditions along y: Periodic (y is a dummy dimension since this is a 1D problem)

## Initial Conditions

Uniform flow:
- `rho = 1.0`
- `u = 0.0`
- `v = 0.0`
- `p = 1.0/gamma`

## Required Input Files

- `solver.inp` - General solver parameters
- `boundary.inp` - Boundary conditions
- `physics.inp` - Physical parameters
- `chemistry.inp` - Photo-chemistry parameters
- `initial.inp` - Initial solution (generated by `aux/init.C`)

See the main PIAFS README for other optional input files.


## Input File Details

### solver.inp

```
begin
	ndims              2
	nvars              11
	size               256 4
	ghost              3
	n_iter             785
	time_scheme        rk
	time_scheme_type   44
	hyp_space_scheme   weno5
	hyp_interp_type    characteristic
	dt                 0.04
	screen_op_iter     5
	file_op_iter       5
	op_file_format     binary
	ip_file_type       binary
	op_overwrite       no
	model              navierstokes2d
end
```

| Parameter | Value | Description |
|-----------|-------|-------------|
| ndims | 2 | Number of spatial dimensions |
| nvars | 11 | Number of solution variables |
| size | 256 4 | Grid size (for 1D) or grid dimensions separated by spaces (for 2D/3D) |
| ghost | 3 | Number of ghost points |
| n_iter | 785 | Number of time iterations |
| time_scheme | rk | Time integration scheme (rk=Runge-Kutta, euler=Forward Euler) |
| time_scheme_type | 44 | RK scheme type (44=RK4, ssprk3=SSP-RK3, etc.) |
| hyp_space_scheme | weno5 | Spatial discretization for hyperbolic terms (weno5, crweno5, muscl3, etc.) |
| hyp_interp_type | characteristic | Interpolation type (characteristic, components) |
| dt | 0.04 | Time step size |
| screen_op_iter | 5 | Iterations between screen output |
| file_op_iter | 5 | Iterations between file output |
| op_file_format | binary | Output format (text, binary, tecplot2d) |
| ip_file_type | binary | Parameter description |
| op_overwrite | no | Overwrite output files (yes, no) |
| model | navierstokes2d | Physical model (euler1d, navierstokes2d, navierstokes3d) |

### boundary.inp

```
4
extrapolate 0  1      0     0   -1e99  1e99
extrapolate 0 -1      0     0   -1e99  1e99
periodic    1  1  -1e99  1e99       0     0 
periodic    1 -1  -1e99  1e99       0     0
```

The boundary.inp file format:
- First line: Number of boundary specifications (4)
- Each subsequent line: type dim face xmin xmax

| Parameter | Description |
|-----------|-------------|
| type | Boundary condition type (periodic, extrapolate, noslip, slip-wall, supersonic_inflow, supersonic_outflow, subsonic_inflow, subsonic_outflow) |
| dim | Spatial dimension (0=x, 1=y, 2=z) |
| face | Face identifier (1=right/top/front, -1=left/bottom/back) |
| xmin, xmax | Range where BC applies |

### physics.inp

```
begin
	gamma             1.4
	upwinding         rf-char
  Re                141.95
  Pr                0.6517
  include_chemistry yes
end
```

| Parameter | Value | Description |
|-----------|-------|-------------|
| gamma | 1.4 | Ratio of specific heats (typically 1.4 for air) |
| upwinding | rf-char | Upwinding scheme (rf-char=Roe-fixed characteristic, rusanov, etc.) |
| Re | 141.95 | Reynolds number |
| Pr | 0.6517 | Prandtl number |
| include_chemistry | yes | Parameter description |

### chemistry.inp

```
begin
  lambda_UV   2.48e-7
  theta       0.0029671
  f_CO2       0.0
  f_O3        0.01
  Ptot        101325.0
  Ti          288
  Lz          0.03
  z_mm        0.0
  nz          20
  t_pulse     1e-8
  F0          2000.0
  sO3         1.1e-21
end
```

Note: Chemistry parameters depend on the specific reaction model.


## How to Run

1. **Generate the initial solution:**
   ```bash
   cd Examples/2D_NavierStokes/BeamInducedDensityMod_1D_x
   g++ aux/init.C -o INIT
   ./INIT
   ```

2. **Run the simulation:**
   ```bash
   # Serial mode
   /path/to/piafs/bin/PIAFS-<compiler>-serial solver.inp

   # Parallel mode (e.g., 8 processes)
   mpiexec -n 8 /path/to/piafs/bin/PIAFS-<compiler>-mpi solver.inp
   ```

3. **Visualize results:**
   - If `op_file_format` is set to `text` in `solver.inp`, solution files can be plotted with Gnuplot or any plotting tool
   - Use Python scripts in `Examples/Python/` for binary format output

## Notes

- The code `aux/init.C` generates the initial solution file in the correct format required by the solver
- The `chemistry.inp` file specifies the photo-chemical reaction parameters that drive the density modulation
- Although the 2D Navier-Stokes solver is used, this is effectively a 1D problem with variation only in the x-direction
