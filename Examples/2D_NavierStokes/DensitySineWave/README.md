# 2D Density Wave Advection

## Overview

Test case for advection of a sinusoidal density perturbation in a uniform 2D flow. This problem has an exact analytical solution and is commonly used to verify the accuracy of numerical schemes for the 2D Navier-Stokes equations.

## Governing Equations

2D Navier-Stokes equations for compressible flows:

```
d   [ rho   ]   d   [   rho*u    ]    d  [   rho*v   ]
--  [ rho*u ] + --  [rho*u*u + p ] +  -- [  rho*u*v  ] = viscous and gravity terms
dt  [ rho*v ]   dx  [   rho*u*v  ]    dy [rho*v*v + p]
    [   e   ]       [   (e+p)*u  ]       [  (e+p)v   ]
```

Where:
- `rho` - density
- `u` - x-velocity
- `v` - y-velocity
- `p` - pressure
- `e` - internal energy

Equation of state:
```
         p         1
e = -------  +   - rho * (u^2+v^2)
    gamma-1      2
```

## Domain and Boundary Conditions

- Domain: `0 <= x,y <= 1.0`
- Boundary conditions: Periodic

## Exact Solution

The density wave advects with the flow velocity:

```
rho = rho_inf + drho * sin(x) * cos(y)
p   = p_inf
u   = u_inf
v   = v_inf
```

Freestream conditions:
- `rho_inf = 1.0`
- `drho = 0.1`
- `p_inf = 1.0/gamma`
- `u_inf = 1.0`
- `v_inf = 1.0`

## Required Input Files

- `solver.inp` - General solver parameters
- `boundary.inp` - Boundary conditions
- `physics.inp` - Physical parameters
- `lusolver.inp` - Parameters for the tridiagonal solver (required for compact schemes)
- `initial.inp` - Initial solution (generated by `aux/exact.C`)
- `exact.inp` - Exact solution (optional, used to compute error; generated by `aux/exact.C`)

See the main PIAFS README for other optional input files.

## How to Run

1. **Generate the initial and exact solutions:**
   ```bash
   cd Examples/2D_NavierStokes/DensitySineWave
   g++ aux/exact.C -o EXACT
   ./EXACT
   ```

2. **Run the simulation:**
   ```bash
   # Serial mode
   /path/to/piafs/bin/PIAFS-<compiler>-serial solver.inp

   # Parallel mode (e.g., 8 processes)
   mpiexec -n 8 /path/to/piafs/bin/PIAFS-<compiler>-mpi solver.inp
   ```

3. **Visualize results:**
   - If `op_file_format` is set to `text` in `solver.inp`, solution files can be plotted with Gnuplot or any plotting tool
   - Use Python scripts in `Examples/Python/` for binary format output
   - Tecplot users can use the file `solution.lay` to visualize the solution

## Notes

- The code `aux/exact.C` generates both the initial and exact solution files in the correct format
- This test case is ideal for accuracy studies since the exact solution is known at all times
- This is a true 2D problem with variation in both x and y directions
