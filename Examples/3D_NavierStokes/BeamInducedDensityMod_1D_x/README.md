# Beam-Induced Density Modulation (1D in x)

## Overview

Simulation of density modulation induced by photo-chemical heating from a laser beam. This test case demonstrates the coupling between fluid dynamics and chemical heating source terms. This is a 1D problem (variation in x only) solved using the 3D Navier-Stokes solver with y and z as dummy dimensions.

## Governing Equations

3D Navier-Stokes equations with chemical heating source term:

```
d   [ rho   ]   d   [   rho*u    ]   d   [   rho*v    ]   d   [   rho*w    ]                    [     0       ]
--  [ rho*u ] + --  [rho*u*u + p ] + --  [  rho*u*v   ] + --  [  rho*u*w   ] =  viscous terms + [     0       ]
dt  [ rho*v ]   dx  [  rho*u*v   ]   dy  [rho*v*v + p ] + dz  [  rho*v*w   ]                    [     0       ]
    [ rho*w ]       [  rho*u*w   ]       [  rho*v*w   ]       [rho*w*w + p ]                    [     0       ]
    [   e   ]       [  (e+p)*u   ]       [  (e+p)*v   ]       [  (e+p)*w   ]                    [ Q/(gamma-1) ]
```

Where:
- `rho` - density
- `u` - x-velocity
- `v` - y-velocity
- `w` - z-velocity
- `p` - pressure
- `e` - total energy
- `Q` - heating due to photo-chemical reactions

Equation of state:
```
         p         1
e = -------  +   - rho * (u^2 + v^2 + w^2)
    gamma-1      2
```

## Non-Dimensionalization

See `aux/init.C` for normalization details.

Physical parameters:
- Reynolds number = 146.5
- Prandtl number = 0.671

## Domain and Boundary Conditions

- Domain: `-2.5*lambda_ac <= x <= 2.5*lambda_ac` (where `lambda_ac` is the acoustic spatial period, see `aux/init.C`)
- Domain in other directions: `0 <= y, z <= y_mm, z_mm`
- Boundary conditions along x: Extrapolate
- Boundary conditions along y and z: Periodic (y and z are dummy dimensions since this is a 1D problem)

## Initial Conditions

Uniform flow:
- `rho = 1.0`
- `u = 0.0`
- `v = 0.0`
- `w = 0.0`
- `p = 1.0/gamma`

## Required Input Files

- `solver.inp` - General solver parameters
- `boundary.inp` - Boundary conditions
- `physics.inp` - Physical parameters
- `chemistry.inp` - Photo-chemistry parameters
- `initial.inp` - Initial solution (generated by `aux/init.C`)

See the main PIAFS README for other optional input files.

## How to Run

1. **Generate the initial solution:**
   ```bash
   cd Examples/3D_NavierStokes/BeamInducedDensityMod_1D_x
   g++ aux/init.C -o INIT
   ./INIT
   ```

2. **Run the simulation:**
   ```bash
   # Serial mode
   /path/to/piafs/bin/PIAFS-<compiler>-serial solver.inp

   # Parallel mode (e.g., 8 processes)
   mpiexec -n 8 /path/to/piafs/bin/PIAFS-<compiler>-mpi solver.inp
   ```

3. **Visualize results:**
   - If `op_file_format` is set to `text` in `solver.inp`, solution files can be plotted with Gnuplot or any plotting tool
   - Use Python scripts in `Examples/Python/` for binary format output

## Notes

- The code `aux/init.C` generates the initial solution file in the correct format required by the solver
- The `chemistry.inp` file specifies the photo-chemical reaction parameters that drive the density modulation
- Although the 3D Navier-Stokes solver is used, this is effectively a 1D problem with variation only in the x-direction
