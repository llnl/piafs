# Isotropic Turbulence Decay (Direct Numerical Simulation)

## Overview

Direct Numerical Simulation (DNS) of isotropic turbulence decay. This example simulates the decay of initially isotropic turbulent flow, capturing the full range of turbulent length scales without modeling. The initial solution is specified in the Fourier space with an energy distribution characteristic of turbulent flow, then transformed to physical space through an inverse Fourier transform.

## Governing Equations

3D Navier-Stokes equations for compressible flows:

```
d   [ rho   ]   d   [   rho*u    ]   d   [   rho*v    ]   d   [   rho*w    ]
--  [ rho*u ] + --  [rho*u*u + p ] + --  [  rho*u*v   ] + --  [  rho*u*w   ] = viscous terms
dt  [ rho*v ]   dx  [  rho*u*v   ]   dy  [rho*v*v + p ] + dz  [  rho*v*w   ]
    [ rho*w ]       [  rho*u*w   ]       [  rho*v*w   ]       [rho*w*w + p ]
    [   e   ]       [  (e+p)*u   ]       [  (e+p)*v   ]       [  (e+p)*w   ]
```

Where:
- `rho` - density
- `u` - x-velocity
- `v` - y-velocity
- `w` - z-velocity
- `p` - pressure
- `e` - total energy

Equation of state:
```
         p         1
e = -------  +   - rho * (u^2 + v^2 + w^2)
    gamma-1      2
```

## Domain and Boundary Conditions

- Domain: `0 <= x, y, z < 2*pi`
- Boundary conditions: Periodic on all boundaries

## Initial Conditions

The initial solution is specified in the Fourier space with an energy distribution similar to that of turbulent flow, then transformed to physical space through an inverse Fourier transform. See `aux/init.c` for implementation details.

## Required Input Files

- `solver.inp` - General solver parameters
- `boundary.inp` - Boundary conditions
- `physics.inp` - Physics-related parameters (including Reynolds number)
- `initial.inp` - Initial solution (generated by `aux/init.c`)

See the main PIAFS README for other optional input files.

## How to Run

1. **Generate the initial solution:**
   ```bash
   cd Examples/3D_NavierStokes/DNS_IsotropicTurbulenceDecay
   # Compile with FFTW3 library
   gcc -I/path/to/fftw3.h -L/path/to/libfftw3.a -lfftw3 aux/init.c -o INIT -lm
   ./INIT
   ```

2. **Run the simulation:**
   ```bash
   # Serial mode
   /path/to/piafs/bin/PIAFS-<compiler>-serial solver.inp

   # Parallel mode (e.g., 8 processes)
   mpiexec -n 8 /path/to/piafs/bin/PIAFS-<compiler>-mpi solver.inp
   ```

3. **Visualize results:**
   - If `op_file_format` is set to `text` in `solver.inp`, solution files can be plotted with Gnuplot or any plotting tool
   - Use Python scripts in `Examples/Python/` for binary format output

4. **Analyze spectral properties (optional):**
   ```bash
   # Compile Fourier analysis tool
   gcc -I/path/to/fftw3.h -L/path/to/libfftw3.a -lfftw3 aux/fourier.c -o FOURIER -lm
   ./FOURIER
   ```

5. **Analyze kinetic energy evolution (optional):**
   ```bash
   # Compile kinetic energy calculation tool
   gcc aux/kineticenergy.c -o KINETICENERGY -lm
   ./KINETICENERGY
   ```

## Notes

- The code `aux/init.c` generates the initial solution file in the correct format required by the solver
- The code `aux/fourier.c` can be used to calculate the initial and final spectrum of the solution
- The code `aux/kineticenergy.c` can be used to calculate the time evolution of the kinetic energy
- Both `aux/init.c` and `aux/fourier.c` require the FFTW3 library (http://www.fftw.org)
- This is a computationally intensive simulation that requires adequate grid resolution to capture all turbulent scales
- The decay of turbulent kinetic energy and the evolution of the energy spectrum are important validation metrics
- This case tests both the inviscid flux computation and the viscous terms implementation
