# Inviscid Advection of Density Fluctuations

## Overview

Simulation of inviscid advection of density fluctuations with a specified initial spectrum in Fourier space. The initial solution is specified in the Fourier space with an energy distribution similar to that of turbulent flow, and then transformed to the physical space through an inverse Fourier transform. This example is useful to analyze the spectral properties of a reconstruction scheme.

## Governing Equations

3D Navier-Stokes equations for compressible flows (inviscid):

```
d   [ rho   ]   d   [   rho*u    ]   d   [   rho*v    ]   d   [   rho*w    ]
--  [ rho*u ] + --  [rho*u*u + p ] + --  [  rho*u*v   ] + --  [  rho*u*w   ] = 0
dt  [ rho*v ]   dx  [  rho*u*v   ]   dy  [rho*v*v + p ] + dz  [  rho*v*w   ]
    [ rho*w ]       [  rho*u*w   ]       [  rho*v*w   ]       [rho*w*w + p ]
    [   e   ]       [  (e+p)*u   ]       [  (e+p)*v   ]       [  (e+p)*w   ]
```

Where:
- `rho` - density
- `u` - x-velocity
- `v` - y-velocity
- `w` - z-velocity
- `p` - pressure
- `e` - total energy

Equation of state:
```
         p         1
e = -------  +   - rho * (u^2 + v^2 + w^2)
    gamma-1      2
```

## Domain and Boundary Conditions

- Domain: `-0.5 <= x, y, z < 0.5`
- Boundary conditions: Periodic on all boundaries

## Initial Conditions

The initial solution is specified in the Fourier space with an energy distribution similar to that of turbulent flow, then transformed to physical space through an inverse Fourier transform. See `aux/exact.C` for implementation details.

## Required Input Files

- `solver.inp` - General solver parameters
- `boundary.inp` - Boundary conditions
- `physics.inp` - Physical parameters
- `initial.inp` - Initial solution (generated by `aux/exact.C`)
- `exact.inp` - Exact solution (symbolic link to `initial.inp`)

See the main PIAFS README for other optional input files.

## How to Run

1. **Generate the initial solution:**
   ```bash
   cd Examples/3D_NavierStokes/DensityFluctuations
   # Compile with FFTW3 library
   g++ -I/path/to/fftw3.h -L/path/to/libfftw3.a -lfftw3 aux/exact.C -o EXACT
   ./EXACT
   # Create symbolic link
   ln -sf initial.inp exact.inp
   ```

2. **Run the simulation:**
   ```bash
   # Serial mode
   /path/to/piafs/bin/PIAFS-<compiler>-serial solver.inp

   # Parallel mode (e.g., 8 processes)
   mpiexec -n 8 /path/to/piafs/bin/PIAFS-<compiler>-mpi solver.inp
   ```

3. **Visualize results:**
   - If `op_file_format` is set to `text` in `solver.inp`, solution files can be plotted with Gnuplot or any plotting tool
   - Use Python scripts in `Examples/Python/` for binary format output

4. **Analyze spectral properties (optional):**
   ```bash
   # Compile Fourier analysis tool
   g++ -I/path/to/fftw3.h -L/path/to/libfftw3.a -lfftw3 aux/fourier.C -o FOURIER
   ./FOURIER
   ```

## Notes

- The code `aux/exact.C` generates the initial solution file in the correct format required by the solver
- The code `aux/fourier.C` can be used to calculate the initial and final spectrum of the solution
- Both codes require the FFTW3 library (http://www.fftw.org)
- This test case is inviscid and therefore does not test the viscous terms implementation
- This example is particularly useful for analyzing the spectral properties and dissipation characteristics of numerical schemes
