# Inviscid Advection of a Density Wave

## Overview

Simulation of inviscid advection of a sinusoidal density wave. This test case demonstrates the ability of the solver to accurately advect density variations while maintaining their shape. This test case is inviscid and therefore does not test the viscous terms implementation.

## Governing Equations

3D Navier-Stokes equations for compressible flows (inviscid):

```
d   [ rho   ]   d   [   rho*u    ]   d   [   rho*v    ]   d   [   rho*w    ]
--  [ rho*u ] + --  [rho*u*u + p ] + --  [  rho*u*v   ] + --  [  rho*u*w   ] = 0
dt  [ rho*v ]   dx  [  rho*u*v   ]   dy  [rho*v*v + p ] + dz  [  rho*v*w   ]
    [ rho*w ]       [  rho*u*w   ]       [  rho*v*w   ]       [rho*w*w + p ]
    [   e   ]       [  (e+p)*u   ]       [  (e+p)*v   ]       [  (e+p)*w   ]
```

Where:
- `rho` - density
- `u` - x-velocity
- `v` - y-velocity
- `w` - z-velocity
- `p` - pressure
- `e` - total energy

Equation of state:
```
         p         1
e = -------  +   - rho * (u^2 + v^2 + w^2)
    gamma-1      2
```

## Domain and Boundary Conditions

- Domain: `0 <= x, y, z <= 1.0`
- Boundary conditions: Periodic on all boundaries

## Initial Conditions

Freestream conditions:
- `rho_inf = 1.0`, `drho = 0.1`
- `p_inf = 1.0/gamma`
- `u_inf = 1.0`
- `v_inf = 1.0`
- `w_inf = 1.0`

Initial/Exact Solution:
- `rho(x,y,z) = rho_inf + drho * sin(x) * cos(y)`
- `p(x,y,z) = p_inf`
- `u(x,y,z) = u_inf`
- `v(x,y,z) = v_inf`
- `w(x,y,z) = w_inf`

## Required Input Files

- `solver.inp` - General solver parameters
- `boundary.inp` - Boundary conditions
- `physics.inp` - Physical parameters
- `lusolver.inp` - Parameters for the tridiagonal solver (required for compact schemes)
- `initial.inp` - Initial solution (generated by `aux/exact.C`)
- `exact.inp` - Exact solution (generated by `aux/exact.C`)

See the main PIAFS README for other optional input files.


## Input File Details

### solver.inp

```
begin
  ndims             3
  nvars             5
  size              32 32 32
  ghost             3
  n_iter            1000
  time_scheme       rk
  time_scheme_type  44
  hyp_space_scheme  crweno5
  hyp_interp_type   components
  dt                0.001
  screen_op_iter    1
  file_op_iter      100
  ip_file_type      binary
  op_file_format    tecplot3d
  op_overwrite      no
  model             navierstokes3d
end
```

| Parameter | Value | Description |
|-----------|-------|-------------|
| ndims | 3 | Number of spatial dimensions |
| nvars | 5 | Number of solution variables |
| size | 32 32 32 | Grid size (for 1D) or grid dimensions separated by spaces (for 2D/3D) |
| ghost | 3 | Number of ghost points |
| n_iter | 1000 | Number of time iterations |
| time_scheme | rk | Time integration scheme (rk=Runge-Kutta, euler=Forward Euler) |
| time_scheme_type | 44 | RK scheme type (44=RK4, ssprk3=SSP-RK3, etc.) |
| hyp_space_scheme | crweno5 | Spatial discretization for hyperbolic terms (weno5, crweno5, muscl3, etc.) |
| hyp_interp_type | components | Interpolation type (characteristic, components) |
| dt | 0.001 | Time step size |
| screen_op_iter | 1 | Iterations between screen output |
| file_op_iter | 100 | Iterations between file output |
| ip_file_type | binary | Parameter description |
| op_file_format | tecplot3d | Output format (text, binary, tecplot2d) |
| op_overwrite | no | Overwrite output files (yes, no) |
| model | navierstokes3d | Physical model (euler1d, navierstokes2d, navierstokes3d) |

### boundary.inp

```
6
periodic      0     1     0     0      0    1.0     0      1.0
periodic      0    -1     0     0      0    1.0     0      1.0
periodic      1     1     0   1.0      0      0     0      1.0
periodic      1    -1     0   1.0      0      0     0      1.0
periodic      2     1     0   1.0      0    1.0     0        0
periodic      2    -1     0   1.0      0    1.0     0        0
```

The boundary.inp file format:
- First line: Number of boundary specifications (6)
- Each subsequent line: type dim face xmin xmax

| Parameter | Description |
|-----------|-------------|
| type | Boundary condition type (periodic, extrapolate, noslip, slip-wall, supersonic_inflow, supersonic_outflow, subsonic_inflow, subsonic_outflow) |
| dim | Spatial dimension (0=x, 1=y, 2=z) |
| face | Face identifier (1=right/top/front, -1=left/bottom/back) |
| xmin, xmax | Range where BC applies |

### physics.inp

```
begin
  gamma     1.4
  upwinding roe
end
```

| Parameter | Value | Description |
|-----------|-------|-------------|
| gamma | 1.4 | Ratio of specific heats (typically 1.4 for air) |
| upwinding | roe | Upwinding scheme (rf-char=Roe-fixed characteristic, rusanov, etc.) |

### weno.inp

```
begin
  mapped        1
  borges        0
  yc            0
  no_limiting   0
  epsilon       0.000001
  p             2.0
  rc            0.3
  xi            0.001
end
```

| Parameter | Value | Description |
|-----------|-------|-------------|
| mapped | 1 | Use mapped WENO (0=no, 1=yes) |
| borges | 0 | Use Borges mapping (0=no, 1=yes) |
| yc | 0 | Use Yamaleev-Carpenter mapping (0=no, 1=yes) |
| no_limiting | 0 | Disable limiting (0=limiting on, 1=no limiting) |
| epsilon | 0.000001 | Small number to avoid division by zero |
| p | 2.0 | Exponent in WENO weights |
| rc | 0.3 | Critical ratio for mapped WENO |
| xi | 0.001 | Parameter for WENO-Z scheme |

### lusolver.inp

```
begin
  reducedsolvetype  jacobi
  evaluate_norm     0
  maxiter           0
  atol              1e-12
  rtol              1e-10
  verbose           0
end
```

| Parameter | Value | Description |
|-----------|-------|-------------|
| reducedsolvetype | jacobi | Parameter description |
| evaluate_norm | 0 | Calculate norms (yes, no) |
| maxiter | 0 | Maximum iterations |
| atol | 1e-12 | Absolute tolerance |
| rtol | 1e-10 | Relative tolerance |
| verbose | 0 | Verbosity level (0=silent, 1=summary, 2=detailed) |


## How to Run

1. **Generate the initial and exact solutions:**
   ```bash
   cd Examples/3D_NavierStokes/DensitySineWave
   g++ aux/exact.C -o EXACT
   ./EXACT
   ```

2. **Run the simulation:**
   ```bash
   # Serial mode
   /path/to/piafs/bin/PIAFS-<compiler>-serial

   # Parallel mode (e.g., 8 processes)
   mpiexec -n 8 /path/to/piafs/bin/PIAFS-<compiler>-mpi
   ```

3. **Visualize results:**
   - If `op_file_format` is set to `text` in `solver.inp`, solution files can be plotted with Gnuplot or any plotting tool
   - Use Python scripts in `Examples/Python/` for binary format output
   - Tecplot users can use the file `solution.lay` to visualize the solution

## Notes

- The code `aux/exact.C` generates both the initial solution file (`initial.inp`) and exact solution file (`exact.inp`) in the correct format required by the solver
- This test case is inviscid and therefore does not test the viscous terms implementation
- The exact solution is known analytically, making this useful for quantitative accuracy assessment
- This case tests the ability of the numerical scheme to maintain the shape of smooth density variations during advection
