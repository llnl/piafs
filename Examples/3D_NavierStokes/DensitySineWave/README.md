# Inviscid Advection of a Density Wave

## Overview

Simulation of inviscid advection of a sinusoidal density wave. This test case demonstrates the ability of the solver to accurately advect density variations while maintaining their shape. This test case is inviscid and therefore does not test the viscous terms implementation.

## Governing Equations

3D Navier-Stokes equations for compressible flows (inviscid):

```
d   [ rho   ]   d   [   rho*u    ]   d   [   rho*v    ]   d   [   rho*w    ]
--  [ rho*u ] + --  [rho*u*u + p ] + --  [  rho*u*v   ] + --  [  rho*u*w   ] = 0
dt  [ rho*v ]   dx  [  rho*u*v   ]   dy  [rho*v*v + p ] + dz  [  rho*v*w   ]
    [ rho*w ]       [  rho*u*w   ]       [  rho*v*w   ]       [rho*w*w + p ]
    [   e   ]       [  (e+p)*u   ]       [  (e+p)*v   ]       [  (e+p)*w   ]
```

Where:
- `rho` - density
- `u` - x-velocity
- `v` - y-velocity
- `w` - z-velocity
- `p` - pressure
- `e` - total energy

Equation of state:
```
         p         1
e = -------  +   - rho * (u^2 + v^2 + w^2)
    gamma-1      2
```

## Domain and Boundary Conditions

- Domain: `0 <= x, y, z <= 1.0`
- Boundary conditions: Periodic on all boundaries

## Initial Conditions

Freestream conditions:
- `rho_inf = 1.0`, `drho = 0.1`
- `p_inf = 1.0/gamma`
- `u_inf = 1.0`
- `v_inf = 1.0`
- `w_inf = 1.0`

Initial/Exact Solution:
- `rho(x,y,z) = rho_inf + drho * sin(x) * cos(y)`
- `p(x,y,z) = p_inf`
- `u(x,y,z) = u_inf`
- `v(x,y,z) = v_inf`
- `w(x,y,z) = w_inf`

## Required Input Files

- `solver.inp` - General solver parameters
- `boundary.inp` - Boundary conditions
- `physics.inp` - Physical parameters
- `lusolver.inp` - Parameters for the tridiagonal solver (required for compact schemes)
- `initial.inp` - Initial solution (generated by `aux/exact.C`)
- `exact.inp` - Exact solution (generated by `aux/exact.C`)

See the main PIAFS README for other optional input files.

## How to Run

1. **Generate the initial and exact solutions:**
   ```bash
   cd Examples/3D_NavierStokes/DensitySineWave
   g++ aux/exact.C -o EXACT
   ./EXACT
   ```

2. **Run the simulation:**
   ```bash
   # Serial mode
   /path/to/piafs/bin/PIAFS-<compiler>-serial solver.inp

   # Parallel mode (e.g., 8 processes)
   mpiexec -n 8 /path/to/piafs/bin/PIAFS-<compiler>-mpi solver.inp
   ```

3. **Visualize results:**
   - If `op_file_format` is set to `text` in `solver.inp`, solution files can be plotted with Gnuplot or any plotting tool
   - Use Python scripts in `Examples/Python/` for binary format output
   - Tecplot users can use the file `solution.lay` to visualize the solution

## Notes

- The code `aux/exact.C` generates both the initial solution file (`initial.inp`) and exact solution file (`exact.inp`) in the correct format required by the solver
- This test case is inviscid and therefore does not test the viscous terms implementation
- The exact solution is known analytically, making this useful for quantitative accuracy assessment
- This case tests the ability of the numerical scheme to maintain the shape of smooth density variations during advection
