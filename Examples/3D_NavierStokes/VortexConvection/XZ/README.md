# Inviscid Isentropic Vortex Convection - XZ Plane

## Overview

Simulation of inviscid isentropic vortex convection where the vortex axis is along the Y-axis and convects along the X-direction. This problem is equivalent to a 2D problem in the XZ plane. This is a classic test case for validating the accuracy and low-dissipation properties of numerical schemes. This test case is inviscid and therefore does not test the viscous terms implementation.

## References

- C.W. Shu, "Essentially Non-oscillatory and Weighted Essentially Non-oscillatory Schemes for Hyperbolic Conservation Laws", ICASE Report 97-65, 1997

## Governing Equations

3D Navier-Stokes equations for compressible flows (inviscid):

```
d   [ rho   ]   d   [   rho*u    ]   d   [   rho*v    ]   d   [   rho*w    ]
--  [ rho*u ] + --  [rho*u*u + p ] + --  [  rho*u*v   ] + --  [  rho*u*w   ] = 0
dt  [ rho*v ]   dx  [  rho*u*v   ]   dy  [rho*v*v + p ] + dz  [  rho*v*w   ]
    [ rho*w ]       [  rho*u*w   ]       [  rho*v*w   ]       [rho*w*w + p ]
    [   e   ]       [  (e+p)*u   ]       [  (e+p)*v   ]       [  (e+p)*w   ]
```

Where:
- `rho` - density
- `u` - x-velocity
- `v` - y-velocity
- `w` - z-velocity
- `p` - pressure
- `e` - total energy

Equation of state:
```
         p         1
e = -------  +   - rho * (u^2 + v^2 + w^2)
    gamma-1      2
```

## Domain and Boundary Conditions

- Domain: `0 <= x, y, z <= 10.0`
- Boundary conditions: Periodic on all boundaries

## Initial Conditions

Freestream conditions:
- `rho = 1.0`
- `p = 1.0/gamma`
- `u = 0.5`
- `v = 0.0`
- `w = 0.0`

Vortex centered at `x0 = 5.0`, `z0 = 5.0`:

```
                (gamma-1)*b^2                   1
    rho = ( 1 - ------------- exp(1-r^2) ) ^ (-------)
                8*gamma*pi^2                  gamma-1

    p   = rho^gamma

             b        1-r^2
    du  = - --- exp [ ----- ] * (z-z0)
            2pi         2

    dv  =  0

             b        1-r^2
    dw  =   --- exp [ ----- ] * (x-x0)
            2pi         2
```

where `r^2 = (x-x0)^2 + (z-z0)^2` and `b` is the vortex strength parameter.

## Required Input Files

- `solver.inp` - General solver parameters
- `boundary.inp` - Boundary conditions
- `physics.inp` - Physical parameters
- `lusolver.inp` - Parameters for the tridiagonal solver (required when using compact schemes)
- `initial.inp` - Initial solution (generated by `aux/init.C`)
- `exact.inp` - Exact solution (generated by `aux/exact.C`)

See the main PIAFS README for other optional input files.

## How to Run

1. **Generate the initial and exact solutions:**
   ```bash
   cd Examples/3D_NavierStokes/VortexConvection/XZ
   g++ aux/init.C -o INIT
   ./INIT
   g++ aux/exact.C -o EXACT
   ./EXACT
   ```

2. **Run the simulation:**
   ```bash
   # Serial mode
   /path/to/piafs/bin/PIAFS-<compiler>-serial solver.inp

   # Parallel mode (e.g., 8 processes)
   mpiexec -n 8 /path/to/piafs/bin/PIAFS-<compiler>-mpi solver.inp
   ```

3. **Visualize results:**
   - If `op_file_format` is set to `text` in `solver.inp`, solution files can be plotted with Gnuplot or any plotting tool
   - Use Python scripts in `Examples/Python/` for binary format output
   - Tecplot users can use the file `solution.lay` to visualize the solution

## Notes

- The code `aux/init.C` generates the initial solution file in the correct format required by the solver
- The code `aux/exact.C` generates the exact solution file for error analysis
- This test case is inviscid and therefore does not test the viscous terms implementation
- The vortex should convect without changing shape in an ideal simulation, making this excellent for assessing numerical dissipation
- This case is particularly sensitive to numerical dissipation and dispersion errors
