# Sod's Shock Tube Problem

## Overview

Classic shock tube problem for testing compressible flow solvers. This test case simulates the evolution of a shock wave, contact discontinuity, and expansion fan resulting from the sudden removal of a diaphragm separating two regions at different pressures.

## Reference

G.A. Sod, "A survey of several finite difference methods for systems of nonlinear hyperbolic conservation laws," J. Comput. Phys., 27, 1 (1978).

## Governing Equations

1D Euler equations for inviscid, compressible flows:

```
d   [ rho   ]   d   [   rho*u    ]
--  [ rho*u ] + --  [rho*u*u + p ] = 0
dt  [   e   ]   dx  [ (e+p)*u    ]
```

Where:
- `rho` - density
- `u` - velocity
- `p` - pressure
- `e` - internal energy

Equation of state:
```
         p         1
e = -------  +   - rho * u^2
    gamma-1      2
```

## Domain and Boundary Conditions

- Domain: `0 <= x <= 1.0`
- Boundary conditions: Extrapolate

## Initial Conditions

Left state (`0 <= x < 0.5`):
- `rho = 1.0`
- `u = 0`
- `p = 1.0`

Right state (`0.5 <= x <= 1.0`):
- `rho = 0.125`
- `u = 0`
- `p = 0.1`

## Required Input Files

- `solver.inp` - General solver parameters
- `boundary.inp` - Boundary conditions
- `physics.inp` - Physical parameters
- `initial.inp` - Initial solution (generated by `aux/init.C`)

See the main PIAFS README for other optional input files.


## Input File Details

### solver.inp

```
begin
  ndims             1
  nvars             3
  size              201
  ghost             3
  n_iter            80
  time_scheme       rk
  time_scheme_type  44
  hyp_space_scheme  weno5
  hyp_interp_type   characteristic
  dt                0.0025
  screen_op_iter    1
  file_op_iter      9999
  op_file_format    text
  op_overwrite      no
  model             euler1d
end
```

| Parameter | Value | Description |
|-----------|-------|-------------|
| ndims | 1 | Number of spatial dimensions |
| nvars | 3 | Number of solution variables |
| size | 201 | Grid size (for 1D) or grid dimensions separated by spaces (for 2D/3D) |
| ghost | 3 | Number of ghost points |
| n_iter | 80 | Number of time iterations |
| time_scheme | rk | Time integration scheme (rk=Runge-Kutta, euler=Forward Euler) |
| time_scheme_type | 44 | RK scheme type (44=RK4, ssprk3=SSP-RK3, etc.) |
| hyp_space_scheme | weno5 | Spatial discretization for hyperbolic terms (weno5, crweno5, muscl3, etc.) |
| hyp_interp_type | characteristic | Interpolation type (characteristic, components) |
| dt | 0.0025 | Time step size |
| screen_op_iter | 1 | Iterations between screen output |
| file_op_iter | 9999 | Iterations between file output |
| op_file_format | text | Output format (text, binary, tecplot2d) |
| op_overwrite | no | Overwrite output files (yes, no) |
| model | euler1d | Physical model (euler1d, navierstokes2d, navierstokes3d) |

### boundary.inp

```
2
extrapolate      0     1     0     0
extrapolate      0    -1     0     0
```

The boundary.inp file format:
- First line: Number of boundary specifications (2)
- Each subsequent line: type dim face xmin xmax

| Parameter | Description |
|-----------|-------------|
| type | Boundary condition type (periodic, extrapolate, noslip, slip-wall, supersonic_inflow, supersonic_outflow, subsonic_inflow, subsonic_outflow) |
| dim | Spatial dimension (0=x, 1=y, 2=z) |
| face | Face identifier (1=right/top/front, -1=left/bottom/back) |
| xmin, xmax | Range where BC applies |

### physics.inp

```
begin
  gamma       1.4
  upwinding   rf-char
end
```

| Parameter | Value | Description |
|-----------|-------|-------------|
| gamma | 1.4 | Ratio of specific heats (typically 1.4 for air) |
| upwinding | rf-char | Upwinding scheme (rf-char=Roe-fixed characteristic, rusanov, etc.) |

### weno.inp

```
begin
  mapped        1
  borges        0
  yc            0
  no_limiting   0
  epsilon       0.000001
  p             2.0
  rc            0.3
  xi            0.001
end
```

| Parameter | Value | Description |
|-----------|-------|-------------|
| mapped | 1 | Use mapped WENO (0=no, 1=yes) |
| borges | 0 | Use Borges mapping (0=no, 1=yes) |
| yc | 0 | Use Yamaleev-Carpenter mapping (0=no, 1=yes) |
| no_limiting | 0 | Disable limiting (0=limiting on, 1=no limiting) |
| epsilon | 0.000001 | Small number to avoid division by zero |
| p | 2.0 | Exponent in WENO weights |
| rc | 0.3 | Critical ratio for mapped WENO |
| xi | 0.001 | Parameter for WENO-Z scheme |


## How to Run

1. **Generate the initial solution:**
   ```bash
   cd Examples/1D_Euler/SodShockTube
   g++ aux/init.C -o INIT
   ./INIT
   ```

2. **Run the simulation:**
   ```bash
   # Serial mode
   /path/to/piafs/bin/PIAFS-<compiler>-serial

   # Parallel mode (e.g., 4 processes)
   mpiexec -n 4 /path/to/piafs/bin/PIAFS-<compiler>-mpi
   ```

3. **Visualize results:**
   - If `op_file_format` is set to `text` in `solver.inp`, solution files can be plotted with Gnuplot or any plotting tool
   - Use Python scripts in `Examples/Python/` for binary format output

## Notes

The code `aux/init.C` generates the initial solution file in the correct format required by the solver.
